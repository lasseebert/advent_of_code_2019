defmodule Advent.Day20Test do
  use Advent.Test.Case

  alias Advent.Day20

  describe "part 1" do
    test "example 1" do
      input = """
               A           
               A           
        #######.#########  
        #######.........#  
        #######.#######.#  
        #######.#######.#  
        #######.#######.#  
        #####  B    ###.#  
      BC...##  C    ###.#  
        ##.##       ###.#  
        ##...DE  F  ###.#  
        #####    G  ###.#  
        #########.#####.#  
      DE..#######...###.#  
        #.#########.###.#  
      FG..#########.....#  
        ###########.#####  
                   Z       
                   Z       
      """

      assert Day20.Part1.shortest_path(input) == 23
    end

    test "example 2" do
      input = """
                         A               
                         A               
        #################.#############  
        #.#...#...................#.#.#  
        #.#.#.###.###.###.#########.#.#  
        #.#.#.......#...#.....#.#.#...#  
        #.#########.###.#####.#.#.###.#  
        #.............#.#.....#.......#  
        ###.###########.###.#####.#.#.#  
        #.....#        A   C    #.#.#.#  
        #######        S   P    #####.#  
        #.#...#                 #......VT
        #.#.#.#                 #.#####  
        #...#.#               YN....#.#  
        #.###.#                 #####.#  
      DI....#.#                 #.....#  
        #####.#                 #.###.#  
      ZZ......#               QG....#..AS
        ###.###                 #######  
      JO..#.#.#                 #.....#  
        #.#.#.#                 ###.#.#  
        #...#..DI             BU....#..LF
        #####.#                 #.#####  
      YN......#               VT..#....QG
        #.###.#                 #.###.#  
        #.#...#                 #.....#  
        ###.###    J L     J    #.#.###  
        #.....#    O F     P    #.#...#  
        #.###.#####.#.#####.#####.###.#  
        #...#.#.#...#.....#.....#.#...#  
        #.#####.###.###.#.#.#########.#  
        #...#.#.....#...#.#.#.#.....#.#  
        #.###.#####.###.###.#.#.#######  
        #.#.........#...#.............#  
        #########.###.###.#############  
                 B   J   C               
                 U   P   P               
      """

      assert Day20.Part1.shortest_path(input) == 58
    end

    @tag :puzzle_input
    test "puzzle input" do
      input = File.read!("input_files/day_20.txt")
      assert Day20.Part1.shortest_path(input) == 490
    end
  end

  describe "part 2" do
    test "example 1" do
      input = """
                   Z L X W       C                 
                   Z P Q B       K                 
        ###########.#.#.#.#######.###############  
        #...#.......#.#.......#.#.......#.#.#...#  
        ###.#.#.#.#.#.#.#.###.#.#.#######.#.#.###  
        #.#...#.#.#...#.#.#...#...#...#.#.......#  
        #.###.#######.###.###.#.###.###.#.#######  
        #...#.......#.#...#...#.............#...#  
        #.#########.#######.#.#######.#######.###  
        #...#.#    F       R I       Z    #.#.#.#  
        #.###.#    D       E C       H    #.#.#.#  
        #.#...#                           #...#.#  
        #.###.#                           #.###.#  
        #.#....OA                       WB..#.#..ZH
        #.###.#                           #.#.#.#  
      CJ......#                           #.....#  
        #######                           #######  
        #.#....CK                         #......IC
        #.###.#                           #.###.#  
        #.....#                           #...#.#  
        ###.###                           #.#.#.#  
      XF....#.#                         RF..#.#.#  
        #####.#                           #######  
        #......CJ                       NM..#...#  
        ###.#.#                           #.###.#  
      RE....#.#                           #......RF
        ###.###        X   X       L      #.#.#.#  
        #.....#        F   Q       P      #.#.#.#  
        ###.###########.###.#######.#########.###  
        #.....#...#.....#.......#...#.....#.#...#  
        #####.#.###.#######.#######.###.###.#.#.#  
        #.......#.......#.#.#.#.#...#...#...#.#.#  
        #####.###.#####.#.#.#.#.###.###.#.###.###  
        #.......#.....#.#...#...............#...#  
        #############.#.#.###.###################  
                     A O F   N                     
                     A A D   M                     
      """

      assert Day20.Part2.shortest_path(input) == 396
    end

    @tag :puzzle_input
    test "puzzle input" do
      input = File.read!("input_files/day_20.txt")
      assert Day20.Part2.shortest_path(input) == 5648
    end
  end
end
